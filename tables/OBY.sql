CREATE TABLE `iasworld.oby`(
  `jur` varchar(6), 
  `parid` varchar(30), 
  `card` decimal(4,0), 
  `taxyr` string, 
  `lline` decimal(4,0), 
  `seq` decimal(3,0), 
  `cur` varchar(1), 
  `who` varchar(10), 
  `wen` string, 
  `whocalc` varchar(10), 
  `wencalc` string, 
  `status` varchar(1), 
  `code` varchar(4), 
  `yrblt` decimal(4,0), 
  `effyr` decimal(4,0), 
  `yrrem` decimal(4,0), 
  `meas1` decimal(6,2), 
  `meas2` decimal(6,2), 
  `wallhgt` decimal(2,0), 
  `area` decimal(9,0), 
  `cubicft` decimal(10,0), 
  `miles` decimal(7,3), 
  `grade` varchar(1), 
  `obymod1` varchar(3), 
  `obymod2` varchar(3), 
  `obymod3` varchar(3), 
  `obymod4` varchar(3), 
  `cond` varchar(1), 
  `funct` varchar(1), 
  `mktadj` decimal(5,2), 
  `units` decimal(8,2), 
  `depr` decimal(5,2), 
  `curmult` decimal(4,3), 
  `locmult` decimal(4,3), 
  `rate` decimal(12,4), 
  `rcn` decimal(10,0), 
  `adjfact` decimal(7,5), 
  `adjrcnld` decimal(10,0), 
  `class` varchar(4), 
  `pctcomp` decimal(3,0), 
  `newconmo` varchar(3), 
  `newconpct` decimal(7,6), 
  `fundep` decimal(3,0), 
  `funrsn` varchar(2), 
  `ecndep` decimal(3,0), 
  `ecnrsn` varchar(2), 
  `rectype` varchar(1), 
  `areasum` decimal(10,0), 
  `exmppct` decimal(5,2), 
  `exmpval` decimal(10,0), 
  `convoby` decimal(10,0), 
  `rateovr` decimal(10,2), 
  `chgrsn` varchar(2), 
  `cndflag` varchar(1), 
  `cndtype` varchar(4), 
  `cndcmplx` varchar(30), 
  `cline` decimal(4,0), 
  `mhmake` varchar(20), 
  `mhmodel` varchar(20), 
  `vect` varchar(500), 
  `user1` varchar(20), 
  `user2` varchar(20), 
  `deactivat` string, 
  `salekey` decimal(8,0), 
  `iasw_id` decimal(10,0), 
  `trans_id` decimal(10,0), 
  `upd_status` varchar(1), 
  `user3` varchar(20), 
  `user4` varchar(20), 
  `user5` varchar(20), 
  `user6` varchar(20), 
  `user7` varchar(20), 
  `user8` varchar(20), 
  `user9` varchar(20), 
  `user10` varchar(20), 
  `user11` varchar(20), 
  `user12` varchar(20), 
  `user13` varchar(20), 
  `user14` varchar(20), 
  `user15` varchar(20), 
  `user16` varchar(20), 
  `user17` varchar(20), 
  `user18` varchar(20), 
  `user19` varchar(20), 
  `user20` varchar(20), 
  `prodate` string, 
  `protype` varchar(1), 
  `prodamage` decimal(3,0), 
  `profact` decimal(4,3), 
  `vectnotes` varchar(500), 
  `areaid` decimal(10,0), 
  `perim` decimal(5,0), 
  `stories` decimal(2,0), 
  `msclass` varchar(2), 
  `msrank` decimal(3,2), 
  `valmeth` varchar(1), 
  `rcnld` decimal(10,0), 
  `ovrrcnld` decimal(10,0), 
  `nccalc` decimal(10,0), 
  `ncoval` decimal(10,0), 
  `ncval` decimal(10,0), 
  `nctot` decimal(10,0), 
  `hga` varchar(1), 
  `recnr` decimal(3,0), 
  `lumpdepr` decimal(10,0), 
  `lumpcure` decimal(10,0), 
  `deprt` varchar(10), 
  `ovrrcn` decimal(10,0), 
  `altbasedate` string, 
  `adjrcn` decimal(10,0), 
  `lcf` decimal(3,2), 
  `condolvl` varchar(30), 
  `condovw` varchar(30), 
  `cdpct` decimal(3,0), 
  `lumpadj` decimal(10,0), 
  `grpadj` decimal(10,0), 
  `excess` varchar(1), 
  `suppress` varchar(1), 
  `lumpcamod` decimal(10,5), 
  `meas1_m` decimal(7,3), 
  `meas2_m` decimal(7,3), 
  `wallhgt_m` decimal(5,3), 
  `cubicmeters` decimal(12,3), 
  `area_sqm` decimal(11,3), 
  `bld_modelid` varchar(80))
STORED AS RCFILE;
        
CREATE TABLE `iasworld.oby_bucketed`(
  `jur` varchar(6), 
  `parid` varchar(30), 
  `card` decimal(4,0), 
  `lline` decimal(4,0), 
  `seq` decimal(3,0), 
  `cur` varchar(1), 
  `who` varchar(10), 
  `wen` string, 
  `whocalc` varchar(10), 
  `wencalc` string, 
  `status` varchar(1), 
  `code` varchar(4), 
  `yrblt` decimal(4,0), 
  `effyr` decimal(4,0), 
  `yrrem` decimal(4,0), 
  `meas1` decimal(6,2), 
  `meas2` decimal(6,2), 
  `wallhgt` decimal(2,0), 
  `area` decimal(9,0), 
  `cubicft` decimal(10,0), 
  `miles` decimal(7,3), 
  `grade` varchar(1), 
  `oby_bucketedmod1` varchar(3), 
  `oby_bucketedmod2` varchar(3), 
  `oby_bucketedmod3` varchar(3), 
  `oby_bucketedmod4` varchar(3), 
  `cond` varchar(1), 
  `funct` varchar(1), 
  `mktadj` decimal(5,2), 
  `units` decimal(8,2), 
  `depr` decimal(5,2), 
  `curmult` decimal(4,3), 
  `locmult` decimal(4,3), 
  `rate` decimal(12,4), 
  `rcn` decimal(10,0), 
  `adjfact` decimal(7,5), 
  `adjrcnld` decimal(10,0), 
  `class` varchar(4), 
  `pctcomp` decimal(3,0), 
  `newconmo` varchar(3), 
  `newconpct` decimal(7,6), 
  `fundep` decimal(3,0), 
  `funrsn` varchar(2), 
  `ecndep` decimal(3,0), 
  `ecnrsn` varchar(2), 
  `rectype` varchar(1), 
  `areasum` decimal(10,0), 
  `exmppct` decimal(5,2), 
  `exmpval` decimal(10,0), 
  `convoby_bucketed` decimal(10,0), 
  `rateovr` decimal(10,2), 
  `chgrsn` varchar(2), 
  `cndflag` varchar(1), 
  `cndtype` varchar(4), 
  `cndcmplx` varchar(30), 
  `cline` decimal(4,0), 
  `mhmake` varchar(20), 
  `mhmodel` varchar(20), 
  `vect` varchar(500), 
  `user1` varchar(20), 
  `user2` varchar(20), 
  `deactivat` string, 
  `salekey` decimal(8,0), 
  `iasw_id` decimal(10,0), 
  `trans_id` decimal(10,0), 
  `upd_status` varchar(1), 
  `user3` varchar(20), 
  `user4` varchar(20), 
  `user5` varchar(20), 
  `user6` varchar(20), 
  `user7` varchar(20), 
  `user8` varchar(20), 
  `user9` varchar(20), 
  `user10` varchar(20), 
  `user11` varchar(20), 
  `user12` varchar(20), 
  `user13` varchar(20), 
  `user14` varchar(20), 
  `user15` varchar(20), 
  `user16` varchar(20), 
  `user17` varchar(20), 
  `user18` varchar(20), 
  `user19` varchar(20), 
  `user20` varchar(20), 
  `prodate` string, 
  `protype` varchar(1), 
  `prodamage` decimal(3,0), 
  `profact` decimal(4,3), 
  `vectnotes` varchar(500), 
  `areaid` decimal(10,0), 
  `perim` decimal(5,0), 
  `stories` decimal(2,0), 
  `msclass` varchar(2), 
  `msrank` decimal(3,2), 
  `valmeth` varchar(1), 
  `rcnld` decimal(10,0), 
  `ovrrcnld` decimal(10,0), 
  `nccalc` decimal(10,0), 
  `ncoval` decimal(10,0), 
  `ncval` decimal(10,0), 
  `nctot` decimal(10,0), 
  `hga` varchar(1), 
  `recnr` decimal(3,0), 
  `lumpdepr` decimal(10,0), 
  `lumpcure` decimal(10,0), 
  `deprt` varchar(10), 
  `ovrrcn` decimal(10,0), 
  `altbasedate` string, 
  `adjrcn` decimal(10,0), 
  `lcf` decimal(3,2), 
  `condolvl` varchar(30), 
  `condovw` varchar(30), 
  `cdpct` decimal(3,0), 
  `lumpadj` decimal(10,0), 
  `grpadj` decimal(10,0), 
  `excess` varchar(1), 
  `suppress` varchar(1), 
  `lumpcamod` decimal(10,5), 
  `meas1_m` decimal(7,3), 
  `meas2_m` decimal(7,3), 
  `wallhgt_m` decimal(5,3), 
  `cubicmeters` decimal(12,3), 
  `area_sqm` decimal(11,3), 
  `bld_modelid` varchar(80))
PARTITIONED BY (taxyr string)
CLUSTERED BY (parid) SORTED BY (seq) INTO 10 BUCKETS
STORED AS PARQUET
TBLPROPERTIES ('parquet.compression'='SNAPPY');
